function email(){return'&copy; EveKS<br /><a class="btn btn-primary center" href="mailto:eveksGGGvkgraberRRRru?subject=vkmanager">eveks@vkgraber&#46;<![if !IE]>r<![endif]>u<\/a>'}function selectNum(){var n=$(":checked").parents(".message-form").length;$("#selected-count").text(n)}function deleateMessage(n){var t=n.parents(".message-form"),r=t.find(".message-description"),f=r.find("pre"),e=t.find(".message-container"),i,o=t.find(".wall-get-id").text(),u=t.find(".is-instagram").data("isinst");i=new FormData;u?i.append("inst",u):i.append("Id",o);sentVkForm(i,"/Options/DeleateText/",t);f.is("pre")||textareaToPre(t,r);uncheckInput(t.find(":checkbox"),e);t.find(".message-unhidden").show();t.find(".message-hidden").hide();selectNum()}function textareaToPre(n,t){var r=t.find("textarea").val(),e=n.find(".wall-get-id").text(),u=n.find(".is-instagram").data("isinst"),i=new FormData,f;i.append("Text",r);u?(f=$(".vk-group-id").eq(0).text(),i.append("inst",u),i.append("group_id",f)):i.append("Id",e);sentVkForm(i,"/Options/ChangeText/",n);n.find(".fa-floppy-o").removeClass("fa-floppy-o").addClass("fa-pencil");t.html($("<pre><\/pre>").text(r))}function uncheckInput(n,t){n.prop("checked",!1);t.css("background-color","rgba(238, 238, 238, 0.50)")}function vkReclass(n){var t=n.children("i");t.is(".up")?(t.removeClass("up"),t.addClass("down")):(t.addClass("up"),t.removeClass("down"))}function vkMessageSort(n,t){for(var r,f,e,i,o=!0,u,s=t.children("i");o;){for(o=!1,r=$(".message-form"),i=0;i<r.length-1;i++)if(u=!1,f=r.eq(i).find(n).text(),e=r.eq(i+1).find(n).text(),s.is(".down")){if(parseInt(f)>parseInt(e)){u=!0;break}}else if(parseInt(f)<parseInt(e)){u=!0;break}u&&(r[i].parentNode.insertBefore(r[i+1],r[i]),o=!0)}}function sentVkForm(n,t,i){$.ajax({url:t,type:"post",data:n,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(n){if(n.ok==="error"&&console.log(n.ok),result=n,i&&n.ok==="ok"&&n.inst_id){var t=i.find(".is-instagram");t.data("isinst",n.inst_id);t.attr("data-isinst",n.inst_id)}},error:function(n,t){console.log(t)}})}function deleateFrom(n){var i=n.data("idfrom"),r,t=new FormData;i==="all"?(r=n.data("group"),t.append("group_id",r),t.append("all","all"),$(".gf-options").hide()):(t.append("group_id",i),n.parents(".gf-options").hide());sentVkForm(t,"/Options/DeleateGroupFrom/")}function replaceText(n,t){var r=n.parents(".message-form"),e=r.find(".message-description"),s=r.find(".wall-get-id").text(),i,u=e.find("pre"),o=e.find("textarea"),f=r.find(".is-instagram").data("isinst");i=new FormData;i.append("text_id",s);i.append("inst",f);u?(f&&(i.append("text",u.text()),i.append("group_id",$(".vk-group-id").eq(0).text())),sendText(i,t,u,!0,r)):(f&&(i.append("text",o.val()),i.append("group_id",$(".vk-group-id").eq(0).text())),sendText(i,t,o,!1,r))}function sendText(n,t,i,r,u){$.ajax({url:t,type:"post",data:n,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(n){if(n.ok==="ok"&&(r==!0?i.text(n.text):i.val(n.text),n.inst_id)){var t=u.find(".is-instagram");t.data("isinst",n.inst_id);t.attr("data-isinst",n.inst_id)}},error:function(n,t){console.log(t)}})}function setValue(n){var t=n.data("options"),i=t.at,r=t.gr,u=t.all,f=t.rf1,e=t.rt1,o=t.rf2,s=t.rt2,h=t.gwl,c=t.gwp,l=t.gwvl,a=t.gwwp,v=t.rtxt,y=t.rt,p=t.ggp,w=t.ra,b=t.cwa,k=t.rs,d=$("#modal-option-new-groups").find("textarea");d.val(i);$("#modal-option-new-groups").find("input.group-id-tag:hidden").val(r);$("#modal-option-new-groups").find("input.group-id-all:hidden").val(u);$("#modal-option-new-groups").find('input[name="RepalaceFrom1"]').val(f);$("#modal-option-new-groups").find('input[name="RepalaceTo1"]').val(e);$("#modal-option-new-groups").find('input[name="RepalaceFrom2"]').val(o);$("#modal-option-new-groups").find('input[name="RepalaceTo2"]').val(s);$("#modal-option-new-groups").find('input[name="GetWithLink"]').prop("checked",isCheck(h));$("#modal-option-new-groups").find('input[name="GetWithPicture"]').prop("checked",isCheck(c));$("#modal-option-new-groups").find('input[name="GetWithVkLink"]').prop("checked",isCheck(l));$("#modal-option-new-groups").find('input[name="GetWithWikiPage"]').prop("checked",isCheck(a));$("#modal-option-new-groups").find('input[name="RemoveText"]').prop("checked",isCheck(v));$("#modal-option-new-groups").find('input[name="RemoveTag"]').prop("checked",isCheck(y));$("#modal-option-new-groups").find('input[name="GetOnlyGroupPost"]').prop("checked",isCheck(p));$("#modal-option-new-groups").find('input[name="RemoveAuthor"]').prop("checked",isCheck(w));$("#modal-option-new-groups").find('input[name="CopyWithAuthor"]').prop("checked",isCheck(b));$("#modal-option-new-groups").find('input[name="RemoveSmile"]').prop("checked",isCheck(k));showHide()}function showHide(){$("#modal-add-groups").modal("hide");$("#modal-add-groups").on("hidden.bs.modal",function(){$("#modal-option-new-groups").modal("show");$(this).off("hidden.bs.modal")})}function isCheck(n){return n===!0||n==="True"||n==="true"}function selectOptions(n,t){for(var i=0;i<n.length;i++)n.eq(i).attr("value")==t&&n.eq(i).prop("selected",!0)}function sendMessage(n,t,i){var r=i.find("button");r.button("loading");$.ajax({url:t,type:"post",data:n,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(n){if(n.ok==="ok"){var t=i.find("#message-submited");t.removeClass("hidden");setTimeout(function(){t.addClass("hidden");i[0].reset()},5e3)}},error:function(n,t){console.log(t)}}).always(function(){r.button("reset")})}var canSend,result;$("#goToTop").on("click",function(n){n.stopPropagation();document.body.scrollTop=0;document.documentElement.scrollTop=0});$("#load-content, #get-messages, #add-group-from, #modal-group-option-submit, #btn-save-token").on("click",function(){var n=$(this);n.button("loading")});$(function(){$("div.thumb.im-prev").on("click",function(n){n.preventDefault();$("#image-modal .modal-body img").attr("src",$(this).find("img").attr("src"));$("#image-modal").modal("show")});$("#image-modal .modal-body img").on("click",function(){$("#image-modal").modal("hide")})});$(function(){$(".copy_txt").html(email())});$(".copy_txt").on("click","a",function(){var n=$(this);n.attr("href",n.attr("href").replace(/GGG/,"@").replace(/RRR/,"."))});$(function(){selectNum()});canSend=!0;$(".message-form").on("click",function(n){var u=$(this).find(":checkbox"),f=$(this).find(".message-container"),s=$(n.target).hasClass("btn-edit")||$(n.target).hasClass("btn-deleate")||$(n.target).hasClass("fa-pencil")||$(n.target).hasClass("fa-trash")||$(n.target).hasClass("message-unhidden")||$(n.target).hasClass("btn-save-text")||$(n.target).is(".btn-tag")||$(n.target).is(".fa-tag")||$(n.target).is(".btn-flink")||$(n.target).is(".fa-link")||$(n.target).is(".btn-user")||$(n.target).is(".fa-user")||$(n.target).is(".btn-external-link")||$(n.target).is(".fa-external-link")||$(n.target).is(".btn-file-text")||$(n.target).is(".fa-file-text")||$(n.target).is(".btn-level-up")||$(n.target).is(".fa-level-up")||$(n.target).is(".thumb-img")||$(n.target).is("textarea"),t,i,e=f.find(".wall-get-id").text(),r=$(this).find(".is-instagram").data("isinst");if(canSend&&!s)if(u.prop("checked")===!0)i="/Options/UnselectText/",t=new FormData,r?(t.append("inst",r),t.append("group_id",$(".vk-group-id").eq(0).text())):t.append("Id",e),sentVkForm(t,i,$(this)),uncheckInput(u,f);else{if(i="/Options/SelectText/",t=new FormData,r){var h=$(this).find(".im-prev .thumb-img").attr("src"),o=$(this).find("pre"),c=$(this).find("textarea"),l=$(this).find(".message-comments").text(),a=$(this).find(".message-like").text(),v=$(this).find(".message-date-hidden").text();t.append("inst",r);t.append("url",h);t.append("group_id",$(".vk-group-id").eq(0).text());t.append("coments",l);t.append("likes",a);t.append("date",v);o?t.append("text",o.text()):t.append("text",c.val())}else t.append("Id",e);sentVkForm(t,i,$(this));u.prop("checked",!0);f.css("background-color","rgba(200, 200, 200, 0.90)")}selectNum()});$(".btn-deleate").on("click",function(n){n.stopPropagation();deleateMessage($(this))});$(".btn-deleate .fa-trash").on("click",function(n){n.stopPropagation();deleateMessage($(this).parent())});$(".message-unhidden").on("click",function(n){n.stopPropagation();var t=$(this).parents(".message-form"),r=t.find(".message-hidden"),u=t.find(".message-unhidden"),i,f=t.find(".wall-get-id").text();i=new FormData;i.append("Id",f);sentVkForm(i,"/Options/UndeleateText/");u.hide();r.show()});$(".btn-edit, .btn-edit .fa-pencil, .btn-edit fa-floppy-o").on("click",function(n){var u,f;n.stopPropagation();var e=$("<span>Сохранить<\/span>").addClass("btn-save-text").addClass("btn").addClass("btn-danger").css("width","100%").css("margin-bottom","15px"),i=$(this).parents(".message-form"),t=i.find(".message-description"),r=t.find("pre");r.is("pre")?(u=r.text(),f=t.outerHeight(),i.find(".fa-pencil").removeClass("fa-pencil").addClass("fa-floppy-o"),t.html($("<textarea><\/textarea>").addClass("form-control").addClass("form-textarea").css("height",f).val(u)).append(e)):textareaToPre(i,t)});$(".message-form").on("click",".btn-save-text",function(n){n.stopPropagation();var t=$(this).parents(".message-form"),i=t.find(".message-description");textareaToPre(t,i)});$("#message-input").keyup(function(){for(var t=$(".message-container"),r,u,f,i,e,o,n=0;n<t.length;n++)(r=t.eq(n).find(".message-title"))&&(i=r.text()),(u=t.eq(n).find(".message-description"))&&(i+=u.text()),(f=t.eq(n).find(".message-group"))&&(i+=f.text()),(e=t.eq(n).find(".message-position"))&&(i+=e.text()),i.length>0&&(o=new RegExp($("#message-input").val(),"i"),t.eq(n)[o.test(i)?"show":"hide"]())});$("#btn-sort-by-like").on("click",function(){vkReclass($(this));vkMessageSort(".message-like",$(this))});$("#btn-sort-by-share").on("click",function(){vkReclass($(this));vkMessageSort(".message-share",$(this))});$("#btn-sort-by-view").on("click",function(){vkReclass($(this));vkMessageSort(".message-view",$(this))});$("#btn-sort-by-date").on("click",function(){vkReclass($(this));vkMessageSort(".message-date-hidden",$(this))});result=$.parseJSON('{ "ok": "error" }');$("#send-messages, #send-selected").on("click",function(n){var i;if(n.stopPropagation(),i=$(this),!i.hasClass("is-disabled")){canSend=!1;$("#send-messages").addClass("is-disabled");$("#send-selected").addClass("is-disabled");setTimeout(function(){$("#send-messages").removeClass("is-disabled");$("#send-selected").removeClass("is-disabled");canSend=!0},5e3);var u=$(":checked").parents(".message-form"),f=$(".vk-group-id").eq(0).text(),t,r=$(".is-instagram").eq(0).data("isinst");t=new FormData;t.append("group_id",f);r&&t.append("inst",r);sentVkForm(t,"/Options/WallPost/");u.hide();result.ok="false"}});$(".deleate-btn-from").on("click",function(n){n.stopPropagation();deleateFrom($(this))});$(".deleate-btn-from .fa-trash").on("click",function(n){n.stopPropagation();deleateFrom($(this).parents(".deleate-btn-from"))});$("img.gif-previous").hover(function(){$(this).attr("src",$(this).data("gif"))},function(){$(this).attr("src",$(this).data("prev"))});$(".btn-tag, .btn-tag .fa-tag").on("click",function(n){n.stopPropagation();replaceText($(this),"/Options/RemoveTag/")});$(".btn-flink, .btn-flink .fa-link").on("click",function(n){n.stopPropagation();replaceText($(this),"/Options/RemoveLink/")});$(".btn-user, .btn-user .fa-user").on("click",function(n){n.stopPropagation();replaceText($(this),"/Options/RemoveAuthor/")});$(".btn-external-link, .btn-external-link .fa-external-link").on("click",function(n){n.stopPropagation();replaceText($(this),"/Options/RemoveWikiLink/")});$(".btn-file-text, .btn-file-text .fa-file-text").on("click",function(n){n.stopPropagation();replaceText($(this),"/Options/RemoveText/")});$(".btn-level-up, .btn-level-up .fa-level-up").on("click",function(n){n.stopPropagation();replaceText($(this),"/Options/BackUpText/")});$(function(){$(".gic-btn .fa-trash").on("click",function(n){n.stopPropagation();var t=new FormData,i=$(this).parents(".gic-btn").data("group");t.append("group_id",i);sentVkForm(t,"/Options/DeleateGroup/");$(this).parents(".group-info-body").hide()})});$(".filter-btn-from").on("click",function(n){n.stopPropagation();var t=$(this);setValue(t)});$(".filter-btn-from .fa-cog").on("click",function(n){n.stopPropagation();var t=$(this).parents(".filter-btn-from");setValue(t)});$("#modal-option-new-groups form").on("submit",function(n){n.preventDefault();n.stopPropagation();var t=$(this),i=t.find("input.group-id-tag:hidden").val(),e=t.find('input[name="RepalaceFrom1"]'),o=t.find('input[name="RepalaceTo1"]'),s=t.find('input[name="RepalaceTo2"]'),h=t.find('input[name="GetWithLink"]'),c=t.find('input[name="GetWithPicture"]'),l=t.find('input[name="GetWithVkLink"]'),a=t.find('input[name="GetWithWikiPage"]'),v=t.find('input[name="RemoveText"]'),y=t.find('input[name="RemoveTag"]'),p=t.find('input[name="GetOnlyGroupPost"]'),w=t.find('input[name="RemoveAuthor"]'),b=t.find('input[name="CopyWithAuthor"]'),k=t.find('input[name="RemoveSmile"]'),r='{"at":"'+t.find("textarea").val()+'","gr":"'+i+'","all":"'+t.find("input.group-id-all:hidden").val()+'","rf1":"'+e.val()+'","rt1":"'+o.val()+'","rf2":"'+t.find('input[name="RepalaceFrom2"]').val()+'","rt2":"'+s.val()+'","gwl":"'+h.prop("checked")+'","gwp":"'+c.prop("checked")+'","gwvl":"'+l.prop("checked")+'","gwwp":"'+a.prop("checked")+'","rtxt":"'+v.prop("checked")+'","rt":"'+y.prop("checked")+'","ggp":"'+p.prop("checked")+'","ra":"'+w.prop("checked")+'","cwa":"'+b.prop("checked")+'","rs":"'+k.prop("checked")+'"}',u='label.filter-btn-from[data-idfrom="'+i+'"]';$(u).data("options",$.parseJSON(r));$(u).attr("data-options",r);var f=$(this),d=f.attr("action"),g=new FormData(f.get(0));sentVkForm(g,d);$("#modal-option-new-groups").modal("hide")});$(".group-info-container .fa-cogs").on("click",function(n){var o,s,h,c;n.stopPropagation();var i=$(this),l=i.data("group"),r=i.data("timef"),u=i.data("timet"),f=i.data("maxfrom"),e=i.data("maxload"),t=$("#modal-vkgroups form");t.find('input[name="group_id"]').val(l);t.find("option").prop("selected",!1);o=t.find('select[name="select_from"]').find("option");s=t.find('select[name="select_to"]').find("option");r!==""&&u!==""&&r&&u?(selectOptions(o,r),selectOptions(s,u)):(selectOptions(o,"30"),selectOptions(s,"30"));h=t.find('.value-block input[name="max_from"]');c=t.find('.value-block input[name="max_load"]');e!==""&&e?c.val(e):c.val("50");f!==""&&f?h.val(f):h.val("30");t.parents("#modal-vkgroups").modal("show")});$("#modal-vkgroups form").on("submit",function(n){n.preventDefault();n.stopPropagation();var i=$(this),s=i.find('input[name="group_id"]').val(),r=i.find('select[name="select_from"] option:selected').attr("value"),u=i.find('select[name="select_to"] option:selected').attr("value"),f=i.find('input[name="max_from"]').val(),e=i.find('input[name="max_load"]').val(),t='.group-info-container i.fa-cogs[data-group="'+s+'"]';$(t).data("timef",r);$(t).attr("data-timef",r);$(t).data("timet",u);$(t).attr("data-timet",u);$(t).data("maxfrom",f);$(t).attr("data-maxfrom",f);$(t).data("maxload",e);$(t).attr("data-maxload",e);var o=$(this),h=o.attr("action"),c=new FormData(o.get(0));sentVkForm(c,h);i.parents("#modal-vkgroups").modal("hide")});$(".number-spinner .btn").on("click",function(n){n.stopPropagation();btn=$(this);input=btn.closest(".number-spinner").find("input");btn.closest(".number-spinner").find(".btn").prop("disabled",!1);btn.attr("data-dir")=="up"?input.attr("max")==undefined||parseInt(input.val())<parseInt(input.attr("max"))?input.val(parseInt(input.val())+1):btn.prop("disabled",!0):input.attr("min")==undefined||parseInt(input.val())>parseInt(input.attr("min"))?input.val(parseInt(input.val())-1):btn.prop("disabled",!0)});$(".number-spinner .text-value").on("change",function(n){n.stopPropagation();var t=$(this);t.attr("max")==undefined||parseInt(t.val())>parseInt(t.attr("max"))?t.val(t.attr("max")):(t.attr("min")==undefined||parseInt(t.val())<parseInt(t.attr("min")))&&t.val(t.attr("min"))});$("#message-contakt").on("submit",function(n){n.stopPropagation();n.preventDefault();var t=$(this),i=new FormData(t.get(0));sendMessage(i,"/Email/GetEmail/",t)});